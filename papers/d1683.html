<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>D1683R0: References for Standard Library Vocabulary Types - an optional&lt;> case study</title>
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in Â§N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li .secno { font-size: 85%; }
	.toc > li li li li li { font-size:   85%;    }
	.toc > li li li li li .secno { font-size: 100%; }

	/* @supports not (display:grid) { */
		.toc > li             { margin: 1.5rem 0;    }
		.toc > li li          { margin: 0.3rem 0;    }
		.toc > li li li       { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}

		.toc li {
			clear: both;
		}

		:not(li) > .toc              { margin-left:  5rem; }
		.toc .secno                  { margin-left: -5rem; }
		.toc > li li li .secno       { margin-left: -7rem; }
		.toc > li li li li .secno    { margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc              { margin-left:  4rem; }
			.toc .secno                  { margin-left: -4rem; }
			.toc > li li li              { margin-left:  1rem; }
			.toc > li li li .secno       { margin-left: -5rem; }
			.toc > li li li li .secno    { margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
	/* } */

	@supports (display:grid) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			   comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover {
			background: rgba(75%, 75%, 75%, .25);
			border-bottom: 3px solid #054572;
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
<style type="text/css">
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      vertical-align: top;
    }
    th, td {
      border-left: none;
      border-right: none;
      padding: 0px 10px;
    }
    th {
      text-align: center;
    }
  </style>
  <meta content="Bikeshed version 1cff2db4ee2c3bba7a4077d3007528ec73b0485d" name="generator">
  <link href="https://isocpp.org/favicon.ico" rel="icon">
  <meta content="abd34a656bdcae2493c3d7c5724968cceb0241fc" name="document-revision">
<style>
pre {
  margin-top: 0px;
  margin-bottom: 0px;
}
.ins, ins, ins *, span.ins, span.ins * {
  background-color: rgb(200, 250, 200);
  color: rgb(0, 136, 0);
  text-decoration: underline;
}
.del, del, del *, span.del, span.del * {
  background-color: rgb(250, 200, 200);
  color: rgb(255, 0, 0);
  text-decoration: line-through;
  text-decoration-color: rgb(255, 0, 0);
}
math, span.math {
  font-family: serif;
  font-style: italic;
}
ul {
  list-style-type: "â ";
}
blockquote {
  counter-reset: paragraph;
}
div.numbered, div.newnumbered {
  margin-left: 2em;
  margin-top: 1em;
  margin-bottom: 1em;
}
div.numbered:before, div.newnumbered:before {
  position: absolute;
  margin-left: -2em;
  display-style: block;
}
div.numbered:before {
  content: counter(paragraph);
  counter-increment: paragraph;
}
div.newnumbered:before {
  content: "ï¿½";
}
div.numbered ul, div.newnumbered ul {
  counter-reset: list_item;
}
div.numbered li, div.newnumbered li {
  margin-left: 3em;
}
div.numbered li:before, div.newnumbered li:before {
  position: absolute;
  margin-left: -4.8em;
  display-style: block;
}
div.numbered li:before {
  content: "(" counter(paragraph) "." counter(list_item) ")";
  counter-increment: list_item;
}
div.newnumbered li:before {
  content: "(ï¿½." counter(list_item) ")";
  counter-increment: list_item;
}
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-syntax-highlighting */

.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "Â¶"; }
.heading > a.self-link::before { content: "Â§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "â";
}
.css::after, .property::after, .descriptor::after {
    content: "â";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "â";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "â";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">D1683R0<br>References for Standard Library Vocabulary Types - an optional&lt;> case study</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Proposal, <time class="dt-updated" datetime="2018-12-19">2018-12-19</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Author:
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:phdofthehouse@gmail.com">JeanHeyd Meneide</a>
     <dt>Audience:
     <dd>LEWG
     <dt>Project:
     <dd>ISO/IEC JTC1/SC22/WG21 14882: Programming Language â C++
     <dt>Latest:
     <dd><a href="https://thephd.github.io/vendor/future_cxx/papers/d1683.html">https://thephd.github.io/vendor/future_cxx/papers/d1683.html</a>
     <dt>Reply To:
     <dd><a href="mailto:phdofthehouse@gmail.com">JeanHeyd Meneide</a>, <a href="https://twitter.com/thephantomderp">@ThePhD</a>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>For over a decade now, the question of how to handle references in Standard Library types has left several standard vocabulary types in a severe limbo. Whether it is std::optional, std::variant, or upcoming abstractions such as std::expected, there is a constant question of how one should handle the fundamental reference types that pervade C++ code. This paper surveys the industry and makes a recommendation as to the proper way to handle optional references in complex wrapper types, using user surveys, code review, field experience and more to inform its design. The paper explores this design space with the canonical composite wrapping type, optional.</p>
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#changelog"><span class="secno">1</span> <span class="content">Revision History</span></a>
     <ol class="toc">
      <li><a href="#changelog-r0"><span class="secno">1.1</span> <span class="content">Revision 0 - July 30th, 2019</span></a>
     </ol>
    <li>
     <a href="#motivation"><span class="secno">2</span> <span class="content">Motivation and History</span></a>
     <ol class="toc">
      <li><a href="#motivation-past"><span class="secno">2.1</span> <span class="content">Stuck in the Past</span></a>
      <li><a href="#motivation-present"><span class="secno">2.2</span> <span class="content">Surveying the Present</span></a>
      <li><a href="#motivation-future"><span class="secno">2.3</span> <span class="content">Impact for the Future</span></a>
      <li><a href="#motivation-fragmentation"><span class="secno">2.4</span> <span class="content">Fragmentation</span></a>
     </ol>
    <li>
     <a href="#design"><span class="secno">3</span> <span class="content">Design Considerations</span></a>
     <ol class="toc">
      <li><a href="#design-behavior"><span class="secno">3.1</span> <span class="content">The Great Big Table of Behaviors</span></a>
      <li>
       <a href="#design-problems"><span class="secno">3.2</span> <span class="content">Problems in the Design Space</span></a>
       <ol class="toc">
        <li><a href="#design-problems-assign-through"><span class="secno">3.2.1</span> <span class="content">Evaluation: Assign Through</span></a>
       </ol>
      <li><a href="#traps-monadic"><span class="secno">3.3</span> <span class="content">Traps: Status Quo, but Monadic?</span></a>
     </ol>
    <li>
     <a href="#solutions"><span class="secno">4</span> <span class="content">Proposed Solution</span></a>
     <ol class="toc">
      <li><a href="#solutions-rebind"><span class="secno">4.1</span> <span class="content">Solution: Rebinding, shallow const, deep comparison reference types</span></a>
     </ol>
    <li>
     <a href="#experience"><span class="secno">5</span> <span class="content">Implementation Experience</span></a>
     <ol class="toc">
      <li><a href="#experience-conservative-rebinding"><span class="secno">5.1</span> <span class="content">Conversative and Rebinding</span></a>
      <li><a href="#experience-assign-through"><span class="secno">5.2</span> <span class="content">Assign-Through: Not Good Enough?</span></a>
      <li><a href="#experience-none"><span class="secno">5.3</span> <span class="content">The Other Choice</span></a>
      <li><a href="#experience-pointer"><span class="secno">5.4</span> <span class="content">So what about Pointers?</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">6</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="changelog"><span class="secno">1. </span><span class="content">Revision History</span><a class="self-link" href="#changelog"></a></h2>
   <h3 class="heading settled" data-level="1.1" id="changelog-r0"><span class="secno">1.1. </span><span class="content">Revision 0 - July 30th, 2019</span><a class="self-link" href="#changelog-r0"></a></h3>
   <ul>
    <li data-md>
     <p>Release.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="motivation"><span class="secno">2. </span><span class="content">Motivation and History</span><a class="self-link" href="#motivation"></a></h2>
   <p>Originally, <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c-></code> -- where <code class="highlight"><c- n>T</c-></code> denotes the name of a type -- contained a specialization to work with regular references, <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>&amp;></c-></code>. When some of the semantics for references were called into question with respect to the assignment operator (assign into the value or rebind the reference inside the optional) and how comparisons would be performed (based on <code class="highlight"><c- k>operator</c-><c- o>&lt;</c-></code> exclusively or forwarding all operations directly to the underlying type), the debate stopped early and no full consensus was reached. Rather than remove just the operator or modify comparison operators, the entirety of <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>&amp;></c-></code> was removed entirely after some consensus was reached around forwarding comparison operations to the underlying type, if present. This left many codebases in an interesting limbo. Previous implementations and external implementations had support for references, while the standard did not and vigorously advocated itself as such through various Committee participants and related firmly asserting that there were two equally valid and hard to pick interpretations.</p>
   <p>This problem became apparent with other parameter and return abstractions such as <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>expected</c-></code>, the Outcome library, <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>variant</c-></code>, and more. Given the scope of the problem, qualitative research was necessary to help capture the uses and intent of references in vocabulary types. <code class="highlight"><c- n>optional</c-></code> was chosen as the primary candidate to collect data, since it is widely used and reimplemented in the C++ ecosystem and broadly represents the challenge of reference wrapping types in C++. A survey conducted of 110+ programmers, (private) feedback from over half a dozen companies, and several analyses of optional reference usage (or not) in the wild has yielded results as to both quality of implementation, existence, and prevalence of references and their use.</p>
   <p>Pointedly: there is strong motivation to have references in base vocabulary types used for both parameters (variant, optional, expected, future, etc.) and a lot of existing practice to do so both before and after the standard settled on its current semantics for <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-></code> and <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>variant</c-></code>. Furthermore, brief historical analysis and user communication reveals the Standards Committee actually had a "chilling effect" on reference support in implementations in large codebases, from private companies to open source projects.</p>
   <p>Finally, given the field experience and absolutely lack of implementation experience with certain implementations, it seems there is only one implementation model that is viable at scale and under the implementation pressures of</p>
   <h3 class="heading settled" data-level="2.1" id="motivation-past"><span class="secno">2.1. </span><span class="content">Stuck in the Past</span><a class="self-link" href="#motivation-past"></a></h3>
   <p>A very large hole is left in many codebases that desire to wrap their non-null optional returns from <code class="highlight"><c- n>T</c-><c- o>*</c-></code> to <code class="highlight"><c- n>T</c-><c- o>&amp;</c-></code>. It has prevented many code bases from migrating from the most popular optional implementations available pre-standardization, such as <a data-link-type="biblio" href="#biblio-akrzemi-optional">akrzemi/optional</a> and <a data-link-type="biblio" href="#biblio-boost-optional">Boost.Optional</a>. It has also prevented adoption in other modern codebases for where the difference between <code class="highlight"><c- n>T</c-><c- o>*</c-></code>, <code class="highlight"><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>&amp;></c-></code>, and <code class="highlight"><c- n>optional</c-><c- o>&lt;</c-><c- n>std</c-><c- o>::</c-><c- n>reference_wrapper</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>></c-></code> alongside programmer intent is significant and non-ignorable, especially in the case of porting code that used to use <code class="highlight"><c- n>boost</c-><c- o>::</c-><c- n>optional</c-></code>. Many of these programmers have decided to either take the very painful route of transitioning, or to simply declare it a non-starter and just use <code class="highlight"><c- n>boost</c-></code>.</p>
   <p>This has forced many library authors in need of a vocabulary "optional" to have to add preprocessor-based switches to use different kinds of optional implementations. For a vocabulary type, <code class="highlight"><c- n>optional</c-></code> contains an incredibly high fragmentation of implementations: some implementations are modeled for easy porting to the standard, but many still have custom support not found in the standard (void specializations, reference handling, monadic functions, and more). Implementation quality varies quite a bit among available optionals, supporting various standards, exception modes, trivial/explicit propagations, reference support, void support, and more.</p>
   <p>Eliminating the need for this by including common goals -- standard goals -- would greatly benefit both library developers and the ecosystem at large with which they interact.</p>
   <h3 class="heading settled" data-level="2.2" id="motivation-present"><span class="secno">2.2. </span><span class="content">Surveying the Present</span><a class="self-link" href="#motivation-present"></a></h3>
   <p>It has been over half a decade since <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-></code> was slated to end up in the standard, even if it only reached the International Standard in C++17. Now that C++ has come this far, this paper is going to take a survey of the landscape and of the many implementations of <code class="highlight"><c- n>optional</c-></code> in order to analyze use cases and experience.</p>
   <p>In furthering this goal, a survey of developers from all experience levels and professional/hobbyist tracks. While there are public implementations of <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-></code> in various flavors and names, it is also important to capture private interests. Several e-mails were sent out as well, and this proposal will attempt to succinctly describe both those and the survey. While the e-mails are kept anonymous and confidential (as that is the condition upon which I have accepted private communications in order to assuage the concerns of employees/employers). This is mostly to protect the innocent and be careful.</p>
   <p>Furthermore, in the C++</p>
   <h3 class="heading settled" data-level="2.3" id="motivation-future"><span class="secno">2.3. </span><span class="content">Impact for the Future</span><a class="self-link" href="#motivation-future"></a></h3>
   <p>The question of references being used in vocabulary types is not just for <code class="highlight"><c- n>optional</c-></code>: all sorts of basic types where references might find their way in because they serve as a class of wrappers/composite/<a class="property" data-link-type="propdesc">transportation</a> types such as <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>variant</c-></code>, <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>tuple</c-></code>, <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>expected</c-></code> and others. The decision here will rest of other vocabulary types, <em>except</em> the case of <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>tuple</c-></code> where C++'s fate has already been decided by <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>tie</c-></code>.</p>
   <p>The solution presented further along in this paper should be extended to the other necessary vocabulary types. Not doing so risks the same degree of questionable design choices for these other types and further indecision that leads to a permeation of implementations that try to do the same things but are subtly incompatible or not very well implemented. Already, <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>expected</c-></code> is seeing a small degree of implementation churn on the outside (not quite as much as <code class="highlight"><c- n>optional</c-></code>).</p>
   <h3 class="heading settled" data-level="2.4" id="motivation-fragmentation"><span class="secno">2.4. </span><span class="content">Fragmentation</span><a class="self-link" href="#motivation-fragmentation"></a></h3>
   <p>As mentioned previously, another key motivation of this paper is the surprising amount of fragmentation that exists in the C++ community regarding the <code class="highlight"><c- n>optional</c-></code> to use. It is an incredibly poor user experience to have several types which perform fundamentally the same operations but to not cover the needs of the vocabulary type that have been demonstrated by codebases for well over a decade now. We counted at least 115 public and private implementations (many of which are listed and referenced in this paper) with varying levels of conformance, performance, and design goals. What is even more troubling is that users continue to roll their own optionals to this day, even on C++17 compliant compilers or standard libraries (e.g., with std::optional being available). Dissatisfaction with the optional provided by the standard library and its lack of features deemed useful by the broader family of C++ programmers means that in some manner the current optional has failed to meet the needs and expectations of the programmers who are both coming to C++ and the programmers who have worked in C++ with boost or similar for a long time.</p>
   <h2 class="heading settled" data-level="3" id="design"><span class="secno">3. </span><span class="content">Design Considerations</span><a class="self-link" href="#design"></a></h2>
   <p>This paper reviews implementation experience, models, and theory around what a composite / wrapper type like <code class="highlight"><c- n>optional</c-></code> should do. This paper also dives into a survey of 110+ developers (plus a few additional members who espoused their opinions directly VIA e-mail, instant messaging mediums, twitter, and elsewhere) to understand what is necessary in the optionals they use in real-world projects, company projects, hobby projects and more.</p>
   <p>This proposal strongly encourages one of the solutions listed below, <a href="#solutions-rebind">Â§4.1 Solution: Rebinding, shallow const, deep comparison reference types</a>. All solutions are explored to thoroughly justify the choice. Particularly, <a href="#design-problems-assign-through">Assign-Through</a>, <a href="#traps-calabrese">Pointer Only</a> and <a href="#traps-pointers">No References, Just Pointers</a> are qualitatively analyzed to determine their suitability in programming environments and how they hold up to expectations in the wild.</p>
   <h3 class="heading settled" data-level="3.1" id="design-behavior"><span class="secno">3.1. </span><span class="content">The Great Big Table of Behaviors</span><a class="self-link" href="#design-behavior"></a></h3>
   <p>Below is a succinct synopsis of the options presented in this paper and their comparison with known solutions and alternative implementations. It does not include the totality of the optional API surface, but has the most exemplary pieces. A key for the symbols:</p>
   <p>âï¸ - Succeeds</p>
   <p>ð« - Compile-Time Error</p>
   <p>â - Runtime Error</p>
   <p>â - Implementation Inconsistency (between engaged/unengaged states, runtime behaviors, etc.)</p>
   <table>
    <tbody>
     <tr>
      <th colspan="6">optional behaviors
     <tr>
      <th>Operation
      <th>T
      <th>std::reference_wrapper&lt;T>
      <th><a href="#solutions-conservative">T&amp; conservative</a>
      <th><em>Proposed:</em><br><a href="#solutions-rebind">T&amp; rebind</a>
      <th><a href="#design-problems-assign-through">T&amp; assign through</a>
     <tr>
      <td>exemplary implementation(s)
      <td>âï¸<br>std::optional<br><a data-link-type="biblio" href="#biblio-martinmoene-optional">nonstd::optional</a><br><a data-link-type="biblio" href="#biblio-llvm-optional">llvm::Optional</a><br><a data-link-type="biblio" href="#biblio-folly-optional">folly::Optional</a>
      <td>âï¸<br>std::optional<br><a data-link-type="biblio" href="#biblio-martinmoene-optional">nonstd::optional</a><br><a data-link-type="biblio" href="#biblio-llvm-optional">llvm::Optional</a><br><a data-link-type="biblio" href="#biblio-folly-optional">folly::Optional</a>
      <td>âï¸<br><a data-link-type="biblio" href="#biblio-akrzemi-optional">std::experimental::optional</a><br><a data-link-type="biblio" href="#biblio-sol2">sol::optional</a>
      <td>âï¸<br><a data-link-type="biblio" href="#biblio-boost-optional">boost::optional</a><br><a data-link-type="biblio" href="#biblio-llama-optional">tl::optional</a><br><a data-link-type="biblio" href="#biblio-foonathan-optional">ts::optional_ref</a>
      <td>ð«<br>...?
     <tr>
      <td><code class="highlight"><c- n>optional</c-><c- p>(</c-><c- k>const</c-> <c- n>optional</c-><c- o>&amp;</c-><c- p>)</c-></code>
      <td>âï¸<br>copy constructs <code class="highlight"><c- n>T</c-></code> (disengaged: nothing)
      <td>âï¸<br>binds reference (disengaged: nothing)
      <td>âï¸<br>binds reference (disengaged: nothing)
      <td>âï¸<br>binds reference (disengaged: nothing)
      <td>âï¸<br>binds reference (disengaged: nothing)
     <tr>
      <td><code class="highlight"><c- n>optional</c-><c- p>(</c-><c- n>optional</c-><c- o>&amp;&amp;</c-><c- p>)</c-></code>
      <td>âï¸<br>move constructs <code class="highlight"><c- n>T</c-></code> (disengaged: nothing)
      <td>âï¸<br>binds reference (disengaged: nothing)
      <td>âï¸<br>binds reference (disengaged: nothing)
      <td>âï¸<br>binds reference (disengaged: nothing)
      <td>âï¸<br>binds reference (disengaged: nothing)
     <tr>
      <td><code class="highlight"><c- n>optional</c-><c- p>(</c-><c- n>T</c-><c- o>&amp;</c-><c- p>)</c-></code>
      <td>âï¸<br>(copy) constructs <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>binds reference
      <td>âï¸<br>binds reference
      <td>âï¸<br>binds reference
      <td>âï¸<br>binds reference
     <tr>
      <td><code class="highlight"><c- n>optional</c-><c- p>(</c-><c- n>T</c-><c- o>&amp;&amp;</c-><c- p>)</c-></code>
      <td>âï¸<br>(move) constructs <code class="highlight"><c- n>T</c-></code>
      <td>ð«<br>compile-time error
      <td>ð«<br>compile-time error
      <td>ð«<br>compile-time error
      <td>ð«<br>compile-time error
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>T</c-><c- o>&amp;</c-><c- p>)</c-></code><br><em>engaged</em>
      <td>âï¸<br>overwrites <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>rebinds data
      <td>ð«<br>compile-time error
      <td>âï¸<br>rebinds data
      <td>âï¸ <sub>â</sub><br>overwrites data
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>T</c-><c- o>&amp;</c-><c- p>)</c-></code><br><em>disengaged</em>
      <td>ï¸âï¸<br>overwrites data
      <td>âï¸<br>rebinds data (overwrites reference wrapper)
      <td>ð«<br>compile-time error
      <td>âï¸<br>rebinds data
      <td>âï¸ <sub>â</sub><br>rebinds data
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>T</c-><c- o>&amp;&amp;</c-><c- p>)</c-></code><br><em>engaged</em>
      <td>âï¸<br>move-assigns <code class="highlight"><c- n>T</c-></code>
      <td>ð«<br>compile-time error
      <td>ð«<br>compile-time error
      <td>ð«<br>compile-time error
      <td>ð« or âï¸ <sub>â</sub><br>compile-time error, or overwrite data?
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>T</c-><c- o>&amp;&amp;</c-><c- p>)</c-></code><br><em>disengaged</em>
      <td>âï¸<br>constructs <code class="highlight"><c- n>T</c-></code>
      <td>ð«<br>compile-time error
      <td>ð«<br>compile-time error
      <td>ð«<br>compile-time error
      <td>ð« or â <sub>â</sub><br>compile-time error, or runtime shenanigans?
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>T</c-><c- o>&amp;</c-><c- p>)</c-></code><br><em>engaged</em>
      <td>âï¸<br>overwrites <code class="highlight"><c- n>T</c-></code>
      <td>ð«<br>compile-time error
      <td>ð«<br>compile-time error
      <td>âï¸<br>rewrites data
      <td>âï¸ <sub>â</sub><br>overwrites data
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>&amp;</c-><c- p>)</c-></code><br><em>disengaged</em>
      <td>ï¸âï¸<br>overwrites data
      <td>âï¸<br>overwrites data
      <td>ð«<br>compile-time error
      <td>âï¸<br>rewrites data
      <td>âï¸ <sub>â</sub><br>rebinds data
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>&amp;&amp;</c-><c- p>)</c-></code><br><em>engaged;</em><br><em>arg engaged</em>
      <td>âï¸<br>move assign <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>rebind data
      <td>âï¸<br>rebind data
      <td>âï¸<br>rebind data
      <td>âï¸<br>move assign <code class="highlight"><c- n>T</c-></code>
     <tr>
      <td><code class="highlight"><c- k>const</c-></code> propagation on <code class="highlight"><c- p>.</c-><c- n>value</c-><c- p>()</c-></code>
      <td>âï¸<br>propagates - deep
      <td>âï¸<br>shallow
      <td>âï¸<br>shallow
      <td>âï¸<br>shallow
      <td>âï¸ <sub>â</sub><br>propagates - deep
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>&amp;&amp;</c-><c- p>)</c-></code><br><em>engaged;</em><br><em>arg disengaged</em>
      <td>âï¸<br>disengage <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>disengage <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>disengage <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>disengage <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>disengage <code class="highlight"><c- n>T</c-></code>
     <tr>
      <td><code class="highlight"><c- k>operator</c-><c- o>=</c-><c- p>(</c-><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>&amp;&amp;</c-><c- p>)</c-></code><br><em>disengaged;</em><br><em>arg disengaged</em>
      <td>âï¸<br>nothing
      <td>âï¸<br>nothing
      <td>âï¸<br>nothing
      <td>âï¸<br>nothing
      <td>âï¸<br>nothing
     <tr>
      <td><code class="highlight"><c- o>*</c-><c- n>my_op</c-> <c- o>=</c-> <c- n>value</c-></code><br><em>engaged</em>
      <td>âï¸<br>copy assigns <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>copy assigns <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>copy assigns <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>copy assigns <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>copy assigns <code class="highlight"><c- n>T</c-></code>
     <tr>
      <td><code class="highlight"><c- o>*</c-><c- n>my_op</c-> <c- o>=</c-> <c- n>value</c-></code><br><em>disengaged</em>
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
     <tr>
      <td><code class="highlight"><c- o>*</c-><c- n>my_op</c-> <c- o>=</c-> <c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>value</c-><c- p>)</c-></code><br><em>engaged</em>
      <td>âï¸<br>move assigns <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>move assigns <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>move assigns <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>move assigns <code class="highlight"><c- n>T</c-></code>
      <td>âï¸<br>move assigns <code class="highlight"><c- n>T</c-></code>
     <tr>
      <td><code class="highlight"><c- o>*</c-><c- n>my_op</c-> <c- o>=</c-> <c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>value</c-><c- p>)</c-></code><br><em>disengaged</em>
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
     <tr>
      <td><code class="highlight"><c- p>(</c-><c- o>*</c-><c- n>my_op</c-><c- p>).</c-><c- n>some_member</c-><c- p>()</c-></code><br><em>engaged</em>
      <td>âï¸<br>calls <code class="highlight"><c- n>some_member</c-><c- p>()</c-></code>
      <td>ð«<br>compile-time error
      <td>âï¸<br>calls <code class="highlight"><c- n>some_member</c-><c- p>()</c-></code>
      <td>âï¸<br>calls <code class="highlight"><c- n>some_member</c-><c- p>()</c-></code>
      <td>âï¸<br>calls <code class="highlight"><c- n>some_member</c-><c- p>()</c-></code>
     <tr>
      <td><code class="highlight"><c- p>(</c-><c- o>*</c-><c- n>my_op</c-><c- p>).</c-><c- n>some_member</c-><c- p>()</c-></code><br><em>disengaged</em>
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
      <td>â<br>runtime error
   </table>
   <h3 class="heading settled" data-level="3.2" id="design-problems"><span class="secno">3.2. </span><span class="content">Problems in the Design Space</span><a class="self-link" href="#design-problems"></a></h3>
   <p>As hinted at in the the table, there are numerous</p>
   <h4 class="heading settled" data-level="3.2.1" id="design-problems-assign-through"><span class="secno">3.2.1. </span><span class="content">Evaluation: Assign Through</span><a class="self-link" href="#design-problems-assign-through"></a></h4>
   <p>This variation of the "complete" solution <a href="#solutions-rebind">found below</a> is an assign-through optional that attempts to mimic the semantics of a reference as much as the <code class="highlight"><c- n>optional</c-></code> specification allows it. This includes assign-through behavior.</p>
   <p>This "solution" is both silly and harmful to programmers due to its change-of-behavior depending purely on a runtime property (engaged vs. unengaged). As shown in <a href="#design-behavior">Â§3.1 The Great Big Table of Behaviors</a>, many of the other options are much more consistent and have much less questions surrounding the totality of its behavior.</p>
   <p>Most notably is the lack of decided semantics for what happens in the engaged state versus the unengaged state with assignment. This version of an <code class="highlight"><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>&amp;></c-></code> would have to rebind for assignment operators that take a right hand side of a l-value. Still, the more dangerous case is the r-value case. <code class="highlight"><c- b>int</c-> <c- n>a</c-> <c- o>=</c-> <c- mi>24</c-><c- p>;</c-> <c- b>int</c-><c- o>&amp;</c-> <c- n>a_ref</c-> <c- o>=</c-> <c- n>a</c-><c- p>;</c-> <c- n>a_ref</c-> <c- o>=</c-> <c- mi>12</c-><c- p>;</c-></code> is valid code: if we are attempting to achieve syntactic purity here, then assignment of optionals would have to tolerate this use case.</p>
   <p>If we do not make r-value assignment a compiler error, then we are left with handling the unenaged state for r-value references in an <code class="highlight"><c- n>optional</c-></code>, of which there is no good answer: do we throw <code class="highlight"><c- n>bad_optional_access</c-></code>? <code class="highlight"><c- n>terminate</c-></code> so it can be <code class="highlight"><c- k>noexcept</c-></code>? These answers and many more do not seem to adequately address the design space, and other decisions like it are increasingly questionable in either utility or usefulness. Having optional references behave as the reference they contain is a poor design choice: trying to gloss over the fact that they are, indeed, optionals is bad in the case of references.</p>
   <p>It is also extremely easy to write code using an assign-through optional where something that may or may not be a code smell cannot be detected simply by looking at the code. Consider the following snippet, adapted from <a data-link-type="biblio" href="#biblio-foonathan-optional-problems">[foonathan-optional-problems]</a>:</p>
<pre class="highlight"><c- b>int</c-> <c- nf>foo_bad</c-><c- p>(</c-><c- b>int</c-> <c- n>x</c-><c- p>,</c-> <c- n>optional</c-><c- o>&lt;</c-><c- b>int</c-><c- o>&amp;></c-> <c- n>maybe_y</c-><c- p>)</c-> <c- p>{</c->
	<c- b>int</c-> <c- n>value</c-> <c- o>=</c-> <c- mi>40</c-><c- p>;</c->
	<c- d>/* lots of code */</c->
	<c- n>maybe_y</c-> <c- o>=</c-> <c- n>value</c-><c- p>;</c->
	<c- d>/* lodes ah kode */</c->
	<c- k>return</c-> <c- mi>24</c-><c- p>;</c->
<c- p>}</c->
</pre>
   <p>In an assign-through world, this code is <em>valid</em> because <code class="highlight"><c- n>maybe_y</c-></code> might <em>actually</em> have something inside of it. In the engaged case, it will assign to whatever was previous bound inside of <code class="highlight"><c- n>maybe_y</c-></code>. This means that you can be asking for dangling reference problems based purely on the engaged vs. unengaged states.</p>
   <p>Static analysis tools cannot definitively point to this code as bad: the best it can offer is a warning, because there exists runtime states where this is exactly what the programmer intended to do. It also creates insanely hard to track bugs. Undefined behavior because a manifestation of a collection of runtime properties rather than a mistake that can be caught immediately by tools or by the eyes of a code reviewer is the front-running poster child for hard to track <a data-link-type="biblio" href="#biblio-heisenbugs">"Heisenbugs"</a>.</p>
   <p>It is extremely clear that assign-through is not good design. It is a non-solution, and this paper actively discourages pursuit of it. This paper furthermore asserts that continued pursuit of a syntatically-equivalent but semantically-riduclous "optional reference that behaves exactly like a reference" is quite firmly outside of the scope of well-reasoned design for the goals of the type. If any optional reference -- and indeed, references in std::variant, std::any, std::expected and other vocabulary types -- goes into the C++ standard, it should <strong>not</strong> be this one.</p>
   <h3 class="heading settled" data-level="3.3" id="traps-monadic"><span class="secno">3.3. </span><span class="content">Traps: Status Quo, but Monadic?</span><a class="self-link" href="#traps-monadic"></a></h3>
   <p>The highest feature request for optional from the conducted survey is monadic operations. This proposal does not go into it: it is detailed in Simon Brandâs <a data-link-type="biblio" href="#biblio-p0798">[p0798]</a>. However, it is critical to note that many of these chained monadic operations cannot be implemented efficiently without some form of reference handling through the optionals. Lots of implicit and uncontrolled copies can result from long chains of <code class="highlight"><c- n>and_then</c-></code> and <code class="highlight"><c- n>map</c-></code> that propogate optionals through, resulting in poor performance unless the user explicitly handles returning <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>reference_wrapper</c-></code>s and similar.</p>
   <h2 class="heading settled" data-level="4" id="solutions"><span class="secno">4. </span><span class="content">Proposed Solution</span><a class="self-link" href="#solutions"></a></h2>
   <p>Originally this proposal laid out a conservative solution and a rebind solution, advocating for the conservative solution. Failure to gain consensus in the Committee during the San Diego 2018 has ruled out the conservative solution. Chief among the concerns was not fully defining all operations and that a type was for a template which originally had stronger semantics was not a good design. Given the discouragement of the conservative solution but the encouragement in continued scholarship and effort in determining the right semantics, the work has been done here to come up with the following solution.</p>
   <h3 class="heading settled" data-level="4.1" id="solutions-rebind"><span class="secno">4.1. </span><span class="content">Solution: Rebinding, shallow const, deep comparison reference types</span><a class="self-link" href="#solutions-rebind"></a></h3>
   <p>This is the "complete" solution that is seen as a step up from the conservative solution. It is the version that has seen adoption in <code class="highlight"><c- n>boost</c-><c- o>::</c-><c- n>optional</c-></code> for over 15 years: it is a rebinding optional reference with <code class="highlight"><c- n>my_op</c-> <c- o>=</c-> <c- n>my_lvalue</c-><c- p>;</c-></code> being a valid expression. It uses C++11 rvalue-references to delete the rvalue-reference assignment and rvalue-reference constructors for a type <code class="highlight"><c- n>T</c-></code>.</p>
   <p>Rebind semantics have the benefit of having no surprises in engaged vs. unengaged states, as shown in <a href="#overview-behavior"></a>.</p>
   <p><code class="highlight"><c- n>boost</c-><c- o>::</c-><c- n>optional</c-></code> is not the only implementation of rebinding optionals. As shown in the table above, there are over 4 publicly available (and highly regarded) optional implementations that have references and behave in this fashion. It is the typical community choice when one is starting a new project, and has been a staple for many years. Among its design is the chief semantic that certain code will always be wrong, no matter what. Consider the code from <a href="#design-problems-assign-through">Â§3.2.1 Evaluation: Assign Through</a>:</p>
<pre class="highlight"><c- b>int</c-> <c- nf>foo_bad</c-><c- p>(</c-><c- b>int</c-> <c- n>x</c-><c- p>,</c-> <c- n>optional</c-><c- o>&lt;</c-><c- b>int</c-><c- o>&amp;></c-> <c- n>maybe_y</c-><c- p>)</c-> <c- p>{</c->
	<c- b>int</c-> <c- n>value</c-> <c- o>=</c-> <c- mi>40</c-><c- p>;</c->
	<c- d>/* lots of code */</c->
	<c- n>maybe_y</c-> <c- o>=</c-> <c- n>value</c-><c- p>;</c->
	<c- d>/* lodes ah kode */</c->
	<c- k>return</c-> <c- mi>24</c-><c- p>;</c->
<c- p>}</c->
</pre>
   <p>Now, the moment anyone sees <code class="highlight"><c- n>maybe_y</c-> <c- o>=</c-> <c- n>value</c-><c- p>;</c-></code>, they immediately know it is an error. It does not change semantic meaning based on runtime properties. It also does not have potentially surprising answers to the question of "how do we handle r-values?"; those are simply compile-time errors, all the time, unless one is using <code class="highlight"><c- n>optional</c-><c- o>&lt;</c-><c- k>const</c-> <c- n>T</c-><c- o>&amp;></c-></code> where the same lifetime rules from above apply to the expression in which <code class="highlight"><c- n>optional</c-><c- o>&lt;</c-><c- k>const</c-> <c- n>T</c-><c- o>&amp;></c-></code> is being used. There are no heisenbugs and no surprises. On this merit alone, rebind is the only sane choice for reference-like handling in <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-></code> and -- indeed -- in any vocabulary type produced by the standard.</p>
   <h2 class="heading settled" data-level="5" id="experience"><span class="secno">5. </span><span class="content">Implementation Experience</span><a class="self-link" href="#experience"></a></h2>
   <p><a href="#solutions-conservative"></a> and <a href="#solutions-rebind">Â§4.1 Solution: Rebinding, shallow const, deep comparison reference types</a> both have design, implementation, and industry experience. <a href="#design-problems-assign-through">Â§3.2.1 Evaluation: Assign Through</a> has not been reported to see much experience (any experience, currently), other than my anecdotal experimentation as a beginning programmer. There is supposedly one assign-through implementation of an optional</p>
   <h3 class="heading settled" data-level="5.1" id="experience-conservative-rebinding"><span class="secno">5.1. </span><span class="content">Conversative and Rebinding</span><a class="self-link" href="#experience-conservative-rebinding"></a></h3>
   <p>The "simple" version is a much more tame version that has seen implementation experience for at least 6 years in <a data-link-type="biblio" href="#biblio-akrzemi-optional">akrzemi/optional</a>, and 4-5 years in <a data-link-type="biblio" href="#biblio-sol2">sol2</a>. The simple version has also existed as the advised compiler-safe subset for <a data-link-type="biblio" href="#biblio-boost-optional">Boost.Optional</a> for 15 years, maybe more (this was mostly from warning about the inability of pre-C++11 to delete or restrict r-value bindings and how <code class="highlight"><c- k>const</c-> <c- n>T</c-><c- o>&amp;</c-></code> could bind to more than was likely intended).</p>
   <p>The "complete" version has seen implementation experience for even longer for those who used the full functionality of <a data-link-type="biblio" href="#biblio-boost-optional">Boost.Optional</a>. It is also present in <a data-link-type="biblio" href="#biblio-llama-optional">Simon Brandâs optional</a>, a number of industry optionals, and the authorâs independent optional. The boost mailing list thread on this topic indicates much of the same potential confusion around references, but towards the end there was the realization that due to inconsistencies with how assign-through behaves the behavior of assign-through is far from ideal.</p>
   <p>Jonathan MÃ¼llerâs <a data-link-type="biblio" href="#biblio-foonathan-optional">type_safe</a> has it, but under a different name (<code class="highlight"><c- n>optional_ref</c-></code>). From MÃ¼llerâs <a data-link-type="biblio" href="#biblio-foonathan-cppnow">C++Now 2018 'Rethinking Pointers' Talk</a>, it is easy to see why: he argues that using a type which very explicitly demarcates its purpose with a name (<code class="highlight"><c- n>optional_ref</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c-></code> as compared to <code class="highlight"><c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>&amp;></c-></code>) is better for an API interface. This works just as fine as any other argument, until the case of generic programming comes around. This is where the difference between <code class="highlight"><c- n>optional_ref</c-></code> and <code class="highlight"><c- n>optional</c-></code> as 2 distinctly named, strong types becomes noticeable and painful for any given developer. This could be smoothed over by having <code class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>typename</c-> <c- n>T</c-><c- o>></c-> <c- k>using</c-> <c- n>optional_ref</c-> <c- o>=</c-> <c- n>optional</c-><c- o>&lt;</c-><c- n>T</c-><c- o>&amp;></c-><c- p>;</c-></code>, which helps the interface be explicit but avoids having to create multiple strong types which will convolute generic programming. Of course, the generic programmer can also add a level of indirection as mentioned in <a data-link-type="biblio" href="#biblio-tcbrindle-post">Tristan Brindleâs musings for Optional References</a>, but this is similar to the whackiness of having to explicitly <code class="highlight"><c- n>unref_unwrap</c-><c- o>&lt;></c-></code> every type just in case <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>reference_wrapper</c-></code> shows up in your generic code.</p>
   <h3 class="heading settled" data-level="5.2" id="experience-assign-through"><span class="secno">5.2. </span><span class="content">Assign-Through: Not Good Enough?</span><a class="self-link" href="#experience-assign-through"></a></h3>
   <p><a href="#design-problems-assign-through">Â§3.2.1 Evaluation: Assign Through</a> has some design experience, but has zero publicly available implementation experience. Only 2 out of 110 survey responses report using an assign-through optional. Neither point to a repository. One is used for projects and hacks, the other is used for a large company project. It is notable that for the individual who reported using an assign-through optional in a company project, there was no firm conviction behind the code: it is "a lazy implementation" that predates boost, and has not actually had a reference put inside of it ever. (In other words, it does not count as implementation experience.) The only other user to have an assign-through optional in their projects put rebinding optionals on their wish list: the only people that appear to want an assign-through optional are the people that never, ever implemented or used one.</p>
   <p>Asides from these two survey respondents, many companies, Boost Users, the twitter-verse, several Discord servers, the CppLang Slack, and many more e-mails to C++ programmers across the globe probed for real significant use of an assign-through optional. Nobody has reported using a non-rebinding or non-conservative optional solution in their code base to date, or if they do they are not aware of it and still need to get back to me.</p>
   <p>This leaves a serious question of the validity and usefulness for <a href="#design-problems-assign-through">Â§3.2.1 Evaluation: Assign Through</a>. It may be that in publishing r0 of this paper, individuals who the author could not reach directly or by survey will come out to inform the author of a non-rebinding reference optional that has seen experience and use as a Studio, Company, and/or shop across the globe. The author encourage everyone to please submit experienced implementations.</p>
   <p>However, given the above, <a href="#design-problems-assign-through">Â§3.2.1 Evaluation: Assign Through</a> appears to be exactly that: a fanciful unicorn that does not exist except for the sole purpose of creating unnecessary and directionless bikeshed. It is a trap that masks itself in the clothes of syntactic similarity with references while having demonstrably harmful properties that cannot stand up to even basic design principles for modern C++'s generally thoughtful and bug-proofing abstractions. It represents a foolish consistency for consistencyâs sake and there should not be a future in which it exists for C++, whether that is C++20 or C++50.</p>
   <h3 class="heading settled" data-level="5.3" id="experience-none"><span class="secno">5.3. </span><span class="content">The Other Choice</span><a class="self-link" href="#experience-none"></a></h3>
   <p>The other choice is, of course, the current status quo: no specialization. Libraries which take this path are <a data-link-type="biblio" href="#biblio-llvm-optional">llvm::Optional</a>, <a data-link-type="biblio" href="#biblio-mnmlstc-optional">core::optional</a>, <a data-link-type="biblio" href="#biblio-martinmoene-optional">optional lite</a>, <a data-link-type="biblio" href="#biblio-abseil-optional">absl::optional</a> and the current <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-></code>.</p>
   <p>Many of these do so because they claim to implement the C++17 version of optional-as-is, and try to keep strict conformance with the specification. Most implementations were done around the time of <a data-link-type="biblio" href="#biblio-n3793">[N3793]</a> or targeted the interface of <a data-link-type="biblio" href="#biblio-n3793">[N3793]</a> because that was the interface that went into the standard. Many of these implementations also claim to provide C++14/17/etc. features to older compilers (even as far back as C++98 for <a data-link-type="biblio" href="#biblio-martinmoene-optional">optional lite</a>): feature-parity (down to the exact same bugs, even) is desirable and necessary for perfect transition and interop between e.g. <code class="highlight"><c- n>absl</c-><c- o>::</c-><c- n>optional</c-></code> and <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>optional</c-></code>. This unfortunately means that no creativity can be taken with the implementation whatsoever. To quote the library author of <a data-link-type="biblio" href="#biblio-mnmlstc-optional">core</a>:</p>
   <blockquote>
    <p><code class="highlight"><c- n>core</c-></code> was an attempt to implement proposals to the letter. Because it [(optional references)] didnât make it in, core doesnât do it. â Isabella Muerte of mnmlstc/core, July 4th, 2018</p>
   </blockquote>
   <p>This does not explain <em>all</em> optional implementations like this, however. For example, <a data-link-type="biblio" href="#biblio-llvm-optional">llvm::Optional</a> does not make it a specialization at all, and its implementation predates the version finally ratified in the standard (it was first introduced to LLVM in 2010, but had existed before then as clang::Optional for quite a few more years).</p>
   <p>David Blaikie of cfe-dev chimed in about the <a data-link-type="biblio" href="#biblio-llvm-optional-history">history of clang::Optional and its successor, llvm::Optional</a> saying that he believes that when there was a need to potentially push it forward, the standards body had already begun to have serious discussion around the current optional proposal. Because that discussion contained contention about assign-through versus rebind, LLVM/Clang simply decided to not try to introduce the idiom into their code base. They therefore stuck with using <code class="highlight"><c- n>T</c-><c- o>*</c-></code> to represent optional values.</p>
   <h3 class="heading settled" data-level="5.4" id="experience-pointer"><span class="secno">5.4. </span><span class="content">So what about Pointers?</span><a class="self-link" href="#experience-pointer"></a></h3>
   <p>Pointers have long been heralded as the proper way to have a rebindable optional reference. Itâs compact in size, already has a none value prepared in <code class="highlight"><c- k>nullptr</c-></code>, and comes with the language itself. It seems to have everything needed. Unfortunately, pointers have problems: chief among them is the requirement that creation of a pointer must be explicit and must come from an l-value. This means that codebases which want to transition from either <code class="highlight"><c- n>boost</c-><c- o>::</c-><c- n>optional</c-><c- o>&lt;</c-><c- k>const</c-> <c- n>T</c-><c- o>&amp;></c-></code> or from changing a <code class="highlight"><c- k>const</c-> <c- n>T</c-><c- o>&amp;</c-></code> parameter to a <code class="highlight"><c- n>T</c-> <c- k>const</c-><c- o>*</c-></code> parameter suffer from hard compiler errors at every place of invocation. While this is not a big deal for some functions, it is an incredibly big deal for core APIs.</p>
   <p>Pointers also introduce lifetime and scoping issues questions and issues: names have to be assigned to temporaries that otherwise had perfect lifetimes that fit exactly the duration of the function call expression: <code class="highlight"><c- n>foo_bar</c-><c- p>(</c-><c- mi>5</c-><c- p>);</c-></code> must become <code class="highlight"><c- b>int</c-> <c- n>temp</c-> <c- o>=</c-> <c- mi>5</c-><c- p>;</c-> <c- n>foo_bar</c-><c- p>(</c-><c- o>&amp;</c-><c- n>temp</c-><c- p>);</c-></code>. While this might be easy to do with integers, it becomes exceedingly complicated for more complex objects and other intricate types. One would have to explicitly control function call lifetime by manually sprinkling brackets around the call site. This does not scale for older codebases wishing to move themselves to more idiomatic and expressive APIs, or for refactors that</p>
   <p>This is not a concern rooted in purely hypothetical thought: 2 survey respondents, a handful of e-mail respondents and several individuals on the CppLang Slack and Discord reported significant pain switching from optional references to <code class="highlight"><c- n>T</c-><c- o>*</c-></code>. A programmer responsible for long-term hobby project wrote in:</p>
   <blockquote>
    <p>Had reference support before upgrading to std::optional, porting those to pointers was quite some work... â Anonymous, July 9th, 2018</p>
   </blockquote>
   <p>There is an observable and significant difference between having to use a pointer and being able to just have the useful lifetime extension rules apply to something that binds to a <code class="highlight"><c- k>const</c-></code> reference. It is especially painful when one wants to upgrade a function to take a parameter that may or may not have used <code class="highlight"><c- k>const</c-> <c- n>T</c-><c- o>&amp;</c-></code> for a parameter that becomes optional. Another way to fix this problem is overloading, but that presents the problem of making it impossible to take the address of a function name without explicitly and directly performing a <code class="highlight"><c- k>static_cast</c-><c- o>&lt;></c-></code>. The only solution that requires absolutely no effort on the part of the programmer is upgrading from <code class="highlight"><c- k>const</c-> <c- n>T</c-><c- o>&amp;</c-></code> to <code class="highlight"><c- n>optional</c-><c- o>&lt;</c-><c- k>const</c-> <c- n>T</c-><c- o>&amp;></c-></code>. Jonathan MÃ¼ller talks about this in his C++Now talk and in a handful of blogposts as well.</p>
   <h2 class="heading settled" data-level="6" id="acknowledgements"><span class="secno">6. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
   <p>Thank you to sol2 users for encouraging me to fix this in the standard. Thank you to Lisa Lippincott for encouraging me to make this and one other proposal after seeing my C++Now 2018 presentation.</p>
   <p>Thank you to Arthur OâDwyer for pointing out that I should survey more than simply optional references, and include all other optionals as well.</p>
   <p>Thank you to Nicole Mazzucca for some sweet code snippets to help display the desirable properties of optional.</p>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">â</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">â</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">â</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Donât scroll to compensate for the ToC if weâre above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I donât know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldnât exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isnât standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we donât have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While weâre at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Canât find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-abseil-optional">[ABSEIL-OPTIONAL]
   <dd>Titus Winters; Google. <a href="https://github.com/abseil/abseil-cpp">abseil</a>. July 4th, 2018. URL: <a href="https://github.com/abseil/abseil-cpp">https://github.com/abseil/abseil-cpp</a>
   <dt id="biblio-akrzemi-optional">[AKRZEMI-OPTIONAL]
   <dd>Andrzej KrzemieÅski. <a href="https://github.com/akrzemi1/Optional">Optional (nullable) objects for C++14</a>. April 23rd, 2018. URL: <a href="https://github.com/akrzemi1/Optional">https://github.com/akrzemi1/Optional</a>
   <dt id="biblio-boost-optional">[BOOST-OPTIONAL]
   <dd>Fernando Luis Cacciola Carballal; Andrzej KrzemieÅski. <a href="https://www.boost.org/doc/libs/1_67_0/libs/optional/doc/html/index.html">Boost.Optional</a>. July 24th, 2018. URL: <a href="https://www.boost.org/doc/libs/1_67_0/libs/optional/doc/html/index.html">https://www.boost.org/doc/libs/1_67_0/libs/optional/doc/html/index.html</a>
   <dt id="biblio-folly-optional">[FOLLY-OPTIONAL]
   <dd>Facebook. <a href="https://github.com/facebook/folly">folly/Optional</a>. August 11th, 2018. URL: <a href="https://github.com/facebook/folly">https://github.com/facebook/folly</a>
   <dt id="biblio-foonathan-cppnow">[FOONATHAN-CPPNOW]
   <dd>Jonathan MÃ¼ller. <a href="https://foonathan.net/cppnow2018.html">C++Now 2018: Rethinking Pointers</a>. May 9th, 2018. URL: <a href="https://foonathan.net/cppnow2018.html">https://foonathan.net/cppnow2018.html</a>
   <dt id="biblio-foonathan-optional">[FOONATHAN-OPTIONAL]
   <dd>Jonathan MÃ¼ller. <a href="https://github.com/foonathan/type_safe">type_safe</a>. June 22nd, 2018. URL: <a href="https://github.com/foonathan/type_safe">https://github.com/foonathan/type_safe</a>
   <dt id="biblio-foonathan-optional-problems">[FOONATHAN-OPTIONAL-PROBLEMS]
   <dd>Jonathan MÃ¼ller. <a href="https://foonathan.net/blog/2018/07/12/optional-reference.html">Let's Talk about std::optional&lt;T&amp;> and optional references</a>. July 12th, 2018. URL: <a href="https://foonathan.net/blog/2018/07/12/optional-reference.html">https://foonathan.net/blog/2018/07/12/optional-reference.html</a>
   <dt id="biblio-heisenbugs">[HEISENBUGS]
   <dd><a href="https://en.wikipedia.org/wiki/Heisenbug">Heisenbugs</a>. August 20th, 2018. URL: <a href="https://en.wikipedia.org/wiki/Heisenbug">https://en.wikipedia.org/wiki/Heisenbug</a>
   <dt id="biblio-llama-optional">[LLAMA-OPTIONAL]
   <dd>Simon Brand (TartanLlama). <a href="https://github.com/TartanLlama/optional">Optional</a>. June 7th, 2018. URL: <a href="https://github.com/TartanLlama/optional">https://github.com/TartanLlama/optional</a>
   <dt id="biblio-llvm-optional">[LLVM-OPTIONAL]
   <dd>LLVM Developer Group. <a href="http://llvm.org/doxygen/Optional_8h_source.html">Optional.h</a>. July 4th, 2018. URL: <a href="http://llvm.org/doxygen/Optional_8h_source.html">http://llvm.org/doxygen/Optional_8h_source.html</a>
   <dt id="biblio-llvm-optional-history">[LLVM-OPTIONAL-HISTORY]
   <dd>David Blaikie. <a href="http://lists.llvm.org/pipermail/cfe-dev/2018-July/058448.html">[ clang::Optional ] History Digging</a>. July 10th, 2018. URL: <a href="http://lists.llvm.org/pipermail/cfe-dev/2018-July/058448.html">http://lists.llvm.org/pipermail/cfe-dev/2018-July/058448.html</a>
   <dt id="biblio-martinmoene-optional">[MARTINMOENE-OPTIONAL]
   <dd>Martin Moene. <a href="https://github.com/martinmoene/optional-lite">Optional Lite</a>. June 21st, 2018. URL: <a href="https://github.com/martinmoene/optional-lite">https://github.com/martinmoene/optional-lite</a>
   <dt id="biblio-mnmlstc-optional">[MNMLSTC-OPTIONAL]
   <dd>Isabella Muerte. <a href="https://mnmlstc.github.io/core/optional.html">core::optional</a>. February 26th, 2018. URL: <a href="https://mnmlstc.github.io/core/optional.html">https://mnmlstc.github.io/core/optional.html</a>
   <dt id="biblio-n3793">[N3793]
   <dd>Fernando Luis Cacciola Carballal; Andrzej KrzemieÅski. <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3793.html">A proposal to add a utility class to represent optional objects (Revision 5)</a>. March 10th, 2013. URL: <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3793.html">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3793.html</a>
   <dt id="biblio-p0798">[P0798]
   <dd>Simon Brand. <a href="https://wg21.tartanllama.xyz/monadic-optional/">Monadic operations for std::optional</a>. May 4th, 2018. URL: <a href="https://wg21.tartanllama.xyz/monadic-optional/">https://wg21.tartanllama.xyz/monadic-optional/</a>
   <dt id="biblio-sol2">[SOL2]
   <dd>ThePhD. <a href="https://github.com/ThePhD/sol2">sol2: C++ &lt;-> Lua Binding Framework</a>. July 3rd, 2018. URL: <a href="https://github.com/ThePhD/sol2">https://github.com/ThePhD/sol2</a>
   <dt id="biblio-tcbrindle-post">[TCBRINDLE-POST]
   <dd>Tristan Brindle. <a href="https://tristanbrindle.com/posts/optional-references">The Case for Optional References</a>. September 16th, 2018. URL: <a href="https://tristanbrindle.com/posts/optional-references">https://tristanbrindle.com/posts/optional-references</a>
  </dl>